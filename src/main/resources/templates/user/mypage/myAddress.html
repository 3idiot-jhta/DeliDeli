<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>사용자 - 내 주소 관리</title>
    <!-- Include:공통 CSS -->
    <th:block th:include="inc/common/common-css :: commonCss"></th:block>
    <!-- Include:User CSS -->
    <th:block th:include="inc/user/user-css :: userCss"></th:block>
    <!-- Include:공통 JS -->
    <th:block th:include="inc/common/common-js :: commonJs"></th:block>
    <!-- Include:User JS -->
    <th:block th:include="inc/user/user-js :: userJs"></th:block>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
    <!-- Start:Header -->
    <th:block th:include="inc/user/header :: userHeader"></th:block>
    <!-- End:Header -->

    <!-- Start:Main -->
    <main id="mainpage__wrap">
        <div class="subPage__wrap">
            <!-- Start:subNav -->
            <th:block th:include="inc/user/subNav :: subNav"></th:block>
            <!-- End:subNav -->
            <h2 class="subPage__title">내 주소관리</h2>
            <div class="myAddress__con">
                <!-- 대표 주소지 -->
                <div th:each="address : ${addressList}" th:if="${address.defaultAddress}">
                    <h2>대표주소지</h2>
                    <p th:text="${address.address} + ' ' + ${address.addrDetail}"></p>
                </div>

                <!-- 일반 주소지 -->
                <div th:each="address, iterStat : ${addressList}" th:unless="${address.defaultAddress}">
                    <h3 th:text="'주소지 ' + ${iterStat.count}"></h3>
                    <p th:text="${address.address} + ' ' + ${address.addrDetail}"></p>
                    <div>
                        <button th:if="${!address.defaultAddress}" th:data-address-key="${address.userAddressKey}" onclick="setDefaultAddress(this)">대표등록</button>
                        <button th:data-address-key="${address.userAddressKey}" th:data-address="${address.address}" th:data-addr-detail="${address.addrDetail}" th:data-zipcode="${address.zipcode}" onclick="showModifyAddressModal(this)">수정</button>
                        <button th:data-address-key="${address.userAddressKey}" onclick="deleteAddress(this)">삭제</button>
                    </div>
                </div>

                <button onclick="showAddAddressModal()">주소 추가</button>

                <!-- 주소 모달창 -->
                <div id="addressModal" style="display: none;">
                    <div>
                        <h2 id="modalTitle">주소 추가</h2>
                        <form id="addressForm">
                            <input type="hidden" id="addressKey" name="addressKey">
                            <label for="newAddress">주소:</label>
                            <input type="text" id="newAddress" name="newAddress" readonly required>
                            <button type="button" onclick="execDaumPostcode()">주소 찾기</button>
                            <br>
                            <label for="newAddrDetail">상세 주소:</label>
                            <input type="text" id="newAddrDetail" name="newAddrDetail" required>
                            <br>
                            <label for="newZipcode">우편번호:</label>
                            <input type="text" id="newZipcode" name="newZipcode" readonly required>
                            <br>
                            <button type="button" onclick="saveAddress()">저장</button>
                            <button type="button" onclick="closeAddressModal()">취소</button>
                        </form>
                    </div>
                </div>

                <script src="/user/js/module/myAddress.js"></script>
            </div>
        </div>
    </main>
    <!-- End:Main -->

    <!-- Start:Footer -->
    <th:block th:include="inc/user/footer :: userFooter"></th:block>
    <!-- End:Footer -->
</body>
</html>
