<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>사용자 - 가게 상세페이지</title>
        <!-- Include:공통 CSS -->
        <th:block th:include="inc/common/common-css :: commonCss"></th:block>
        <!-- Include:User CSS -->
        <th:block th:include="inc/user/user-css :: userCss"></th:block>
        <!-- Include:공통 JS -->
        <th:block th:include="inc/common/common-js :: commonJs"></th:block>
        <!-- Include:User JS -->
        <th:block th:include="inc/user/user-js :: userJs"></th:block>
    </head>
    <body>
        <!-- Start:Header -->
        <th:block th:include="inc/user/header :: userHeader"></th:block>
        <!-- End:Header -->

        <!-- Start:Main -->
        <main id="mainpage__wrap">
            <!-- 가게 정보 -->
            <div class="store-detail">
                <div class="store-image">
                    <img th:src="${store.storeProfileImg}" alt="가게 이미지">
                </div>
                <div class="store-info">
                    <h1 th:text="${store.storeName}">가게 이름</h1>
                    <p th:text="'⭐ ' + ${store.averageRating} + ' (' + ${store.reviewCount} + ' 리뷰)'"></p>
                    <p th:text="'최소주문금액 ' + ${store.minOrderAmount} + '원'"></p>
                    <p th:text="'배달비 ' + ${store.deliveryAmount1} + '원 ~ ' + ${store.deliveryAmount3} + '원'"></p>
                    <p th:text="'가게 오픈 시간 ' + ${store.openTime}"></p>
                    <p th:text="'가게 마감 시간 ' + ${store.closeTime}"></p>

                    <!-- 로그인한 사용자만 보이는 찜 버튼 -->
                    <div th:if="${user != null}">
                        <button id="wishlist-btn" th:data-store-info-key="${store.storeInfoKey}" th:text="${isLiked} ? '찜 취소' : '찜하기'"></button>
                    </div>
                </div>
            </div>

            <!-- 메뉴, 리뷰, 가게 정보 탭 -->
            <div class="tab-container">
                <ul class="tabs">
                    <li class="tab" th:classappend="${tab == 'menu'} ? 'active' : ''">
                        <a th:href="@{'/user/storeDetail/' + ${store.storeInfoKey} + '?tab=menu'}">메뉴</a>
                    </li>
                    <li class="tab" th:classappend="${tab == 'review'} ? 'active' : ''">
                        <a th:href="@{'/user/storeDetail/' + ${store.storeInfoKey} + '?tab=review'}">리뷰</a>
                    </li>
                    <li class="tab" th:classappend="${tab == 'info'} ? 'active' : ''">
                        <a th:href="@{'/user/storeDetail/' + ${store.storeInfoKey} + '?tab=info'}">가게 정보</a>
                    </li>
                </ul>
                <br><br><br>

                <!-- 메뉴 탭 -->
                <div class="tab-content" th:if="${tab == 'menu'}">
                    <div th:each="entry : ${groupedMenus}">
                        <div class="menu-group">
                            <h3 th:text="${entry.key.menuGroupName}" style="cursor: pointer;">메뉴 그룹 이름</h3>
                            <div th:each="menu : ${entry.value}" style="display:none;">
                                <div class="menu-item" th:data-menu-key="${menu.menuKey}" style="cursor: pointer;">
                                    <p th:text="${menu.menuName}"></p>
                                    <p th:text="${menu.menuPrice} + '원'"></p>
                                    <img th:src="${menu.menuImg}" alt="메뉴 이미지">
                                </div>
                            </div>
                        </div>
                        <br><br><br>
                    </div>
                </div>

                <!-- 메뉴 상세 모달 -->
                <div id="menuModal" class="modal" style="display:none;">
                    <div class="modal-content">
                        <span class="close" onclick="closeModal()">&times;</span>
                        <div id="menuDetailContent"></div>
                    </div>
                </div>

                <!-- 리뷰 탭 -->
                <div class="tab-content" th:if="${tab == 'review'}">
                    <div th:each="review : ${reviewList}">
                        <p th:text="${review.reviewRating} + '⭐'"></p>
                        <p th:text="${review.reviewDesc}"></p>
                        <img th:src="${review.reviewPhoto1}" alt="리뷰 이미지" th:if="${review.reviewPhoto1 != null}">
                        <img th:src="${review.reviewPhoto2}" alt="리뷰 이미지" th:if="${review.reviewPhoto2 != null}">
                    </div>
                </div>

                <!-- 가게 정보 탭 -->
                <div class="tab-content" th:if="${tab == 'info'}">
                    <!-- 기본 가게 정보 -->
                    <h2>가게 정보</h2>
                    <p th:text="'상호: ' + ${store.storeName}">상호명</p>
                    <p th:text="'전화번호: ' + ${store.storePhone}">전화번호</p>
                    <p th:text="'주소: ' + ${store.storeAddress} + ' ' + ${store.storeAddrDetail}">주소</p>
                    <p>영업시간</p>
                    <p th:text="'가게 오픈 시간: ' + ${store.openTime}">오픈 시간</p>
                    <p th:text="'가게 마감 시간: ' + ${store.closeTime}">마감 시간</p>
                    <br><br><br>

                    <!-- 가게 소개 -->
                    <h3>가게 소개</h3>
                    <div>
                        <p th:text="${store.storeDetailInfo}">가게 소개 내용</p>
                        <img th:src="${store.storeProfileImg}" alt="가게 이미지">
                    </div>
                    <br><br><br>

                    <!-- 배달비 안내 -->
                    <h3>배달비 안내</h3>
                    <table>
                        <thead>
                        <tr>
                            <th>주문금액</th>
                            <th>배달비</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:if="${store.orderAmount1 != null}">
                            <td th:text="'주문금액 ' + ${store.orderAmount1} + '원 이상'"></td>
                            <td th:text="${store.deliveryAmount1} + '원'"></td>
                        </tr>
                        <tr th:if="${store.orderAmount2 != null}">
                            <td th:text="'주문금액 ' + ${store.orderAmount2} + '원 이상'"></td>
                            <td th:text="${store.deliveryAmount2} + '원'"></td>
                        </tr>
                        <tr th:if="${store.orderAmount3 != null}">
                            <td th:text="'주문금액 ' + ${store.orderAmount3} + '원 이상'"></td>
                            <td th:text="${store.deliveryAmount3} + '원'"></td>
                        </tr>
                        </tbody>
                    </table>
                    <br><br><br>

                    <!-- 사업자 정보 -->
                    <h3>사업자 정보</h3>
                    <p th:text="'대표자명: ' + ${store.clientName}">대표자명</p>
                    <p th:text="'상호명: ' + ${store.storeName}">상호명</p>
                    <p th:text="'사업자등록번호: ' + ${store.clientEID}">사업자등록번호</p>
                    <p th:text="'전화번호: ' + ${store.clientPhone}">전화번호</p>
                    <br><br><br>

                    <!-- 원산지 정보 -->
                    <h3>원산지 정보</h3>
                    <p th:text="'원산지 정보: ' + ${store.storeOriginInfo}">전화번호</p>

                </div>
            </div>

            <script src="/user/js/module/storeDetail.js"></script>
        </main>
        <!-- End:Main -->

        <!-- Start:Footer -->
        <th:block th:include="inc/user/footer :: userFooter"></th:block>
        <!-- End:Footer -->
    </body>
</html>
